<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            margin: 0;
            /* background-color: blueviolet !important; */
        }
    </style>
</head>

<body>
    <canvas id="pr">

    </canvas>

    <script>
        let canvas = document.getElementById("pr");

        let ctx = canvas.getContext("2d");


        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        var arrowSize = 20;

        var intervalId_0, intervalId_1, intervalId_2, intervalId_3

        function Circle(radius, arrowX, circleX, yDistance, arrowDx, arrowDy, color, clickedCircle) { //class

            this.radius = radius;
            this.arrowX = arrowX;
            this.circleX = circleX;
            this.yDistance = yDistance;
            this.arrowDx = arrowDx;
            this.arrowDy = arrowDy;
            this.color = color;
            this.animationId = clickedCircle;

            this.draw = function () {
                ctx.beginPath(); // this clear the entire canvas! event listener
                ctx.arc(this.circleX, this.yDistance, this.radius, 0, 2 * Math.PI, false)
                ctx.lineWidth = 5;
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                // arrow

                ctx.beginPath();
                ctx.lineWidth = 5;
                ctx.moveTo(this.arrowX - arrowSize, this.yDistance);
                ctx.lineTo(this.arrowX, this.yDistance);

                ctx.fill();
                ctx.stroke();
                ctx.lineCap = "round";

                ctx.closePath();

                // Draw the arrowhead
                ctx.beginPath();

                ctx.moveTo(this.arrowX - arrowSize, this.yDistance - arrowSize / 2);
                ctx.lineTo(this.arrowX - arrowSize, this.yDistance + arrowSize / 2);
                ctx.lineTo(this.arrowX - arrowSize * 2, this.yDistance);
                ctx.fillStyle = this.colors;
                ctx.fill();
                ctx.closePath();
            }


            this.update = function (circleNumber) {
                 

                //arrow
                ctx.beginPath();
                ctx.lineWidth = 5;
                ctx.moveTo(this.arrowX - arrowSize, this.yDistance);
                ctx.lineTo(this.arrowX, this.yDistance);

                ctx.fill();
                ctx.stroke();
                ctx.lineCap = "round";

                ctx.closePath();

                // Draw the arrowhead

                ctx.beginPath();

                ctx.moveTo(this.arrowX - arrowSize, this.yDistance - arrowSize / 2);
                ctx.lineTo(this.arrowX - arrowSize, this.yDistance + arrowSize / 2);
                ctx.lineTo(this.arrowX - arrowSize * 2, this.yDistance);
                ctx.fillStyle = this.colors;
                ctx.fill();
                ctx.closePath();

                if (this.arrowX   < circleX + 2 *this.radius -1) {

                    if (circleNumber === 0) {

                        clearInterval(intervalId_0);
                    }
                    if (circleNumber === 1) {

                        clearInterval(intervalId_1);
                    }
                    if (circleNumber === 2) {

                        clearInterval(intervalId_2);
                    }
                    if (circleNumber === 3) {

                        clearInterval(intervalId_3);
                    }
                   
                    this.color = "blue";
                }
                this.arrowX -= this.arrowDx; // increment the x distance !
                this.draw();
            }
        }

 

        const colors = ["red", "green", "blue", "yellow"];

        var clickedCircle = null;
        var CircleArray = [];
        let radius = 50;
        let arrowX = 400;
        let circleX = 100;
        let xDistance = 100;

        let dx = 3;
        let dy = 3;


        const yDistance = [100, 250, 400, 550]

        for (var i = 0; i <= 3; i++) {
            

            CircleArray.push(new Circle(radius, arrowX, circleX, yDistance[i], dx, dy, colors[i], clickedCircle));
        }

        console.log(CircleArray)

        var animationCounter = 0;
        // now i am going to add event listener!!

        let click = {
            x: "",
            y: "",
        }



        window.addEventListener("click", function (event) {
            click.x = event.offsetX;
            click.y = event.offsetY;
            if (
                click.x >= circleX - radius &&
                click.x <= circleX + radius &&
                click.y >= yDistance[0] - radius &&
                click.y <= yDistance[0] + radius && clickedCircle != 0

            ) {

                console.log("1st circle clicked");
                if (click.x >= xDistance - radius) {
                    clickedCircle = 0;
                    intervalId_0 = setInterval(() => {
                        animate(0)
                    }, 30)
                }
            }

            else if (
                click.x >= circleX - radius &&
                click.x <= circleX + radius &&
                click.y >= yDistance[1] - radius &&
                click.y <= yDistance[1] + radius && clickedCircle != 1
            ) {

                console.log("2nd circle clicked");
                if (click.x >= xDistance - radius) {
                    clickedCircle = 1;

                    intervalId_1 = setInterval(() => {
                        animate(1)
                    }, 30)
                }
            }

            else if (
                click.x >= circleX - radius &&
                click.x <= circleX + radius &&
                click.y >= yDistance[2] - radius &&
                click.y <= yDistance[2] + radius && clickedCircle != 2
            ) {

                console.log("3rd circle clicked");
                if (click.x >= xDistance - radius) {
                    clickedCircle = 2;
                    intervalId_2 = setInterval(() => {
                        animate(2)
                    }, 30)
                }

            }

            if (
                click.x >= circleX - radius &&
                click.x <= circleX + radius &&
                click.y >= yDistance[3] - radius &&
                click.y <= yDistance[3] + radius && clickedCircle != 3
            ) {

                console.log("4th circle clicked");
                if (click.x >= xDistance - radius) {
                    clickedCircle = 3;
                    intervalId_3 = setInterval(() => {
                        animate(3)
                    }, 30)
                }

            }

        })

        function animate(clickedCircle) {


            ctx.clearRect(0, 0, canvas.width, canvas.height);

            CircleArray[clickedCircle].update(clickedCircle);
            for (var i = 0; i < CircleArray.length; i++) {
                CircleArray[i].draw();
            }


        }

        for (var i = 0; i < CircleArray.length; i++) {

            CircleArray[i].update();
        }



    </script>

</body>

</html>